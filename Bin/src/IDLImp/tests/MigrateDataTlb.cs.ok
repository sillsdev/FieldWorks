// --------------------------------------------------------------------------------------------
// Copyright (c) 2007, SIL International. All rights reserved.
//
// File: MigrateDataTlb.cs
// Responsibility: Generated by IDLImporter
// Last reviewed:
//
// <remarks>
// Generated by IDLImporter from file MigrateDataTlb.idl
//
// You should use these interfaces when you access the COM objects defined in the mentioned
// IDL/IDH file.
// </remarks>
// --------------------------------------------------------------------------------------------
namespace SIL.Fieldworks.Test
{
	using LanguageLib;
	using FwKernelLib;
	using Views;
	using System;
	using System.Runtime.InteropServices;
	using System.Runtime.CompilerServices;
	using System.Windows.Forms;
	using stdole;


	[ComImport()]
	[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
	[Guid("7BF2BC32-A603-4ba1-AC1F-B59D9F5FED8B")]
	public interface IMigrateData
	{

		void Migrate(IOleDbEncap _ode, int nDestVersion, bool _fStillValid);
	}

	#region MigrateData CoClass definitions
	[ComImport()]
	[CoClass(typeof(_MigrateDataClass))]
	[Guid("7BF2BC32-A603-4ba1-AC1F-B59D9F5FED8B")]
	public interface MigrateData : IMigrateData
	{
	}

	#region Private _MigrateDataClass class
	[ComImport()]
	[ClassInterface(ClassInterfaceType.None)]
	[TypeLibType(TypeLibTypeFlags.FCanCreate)]
	[Guid("461989B4-CA92-4eab-8CAD-ADB28C3B4D10")]
	internal class _MigrateDataClass : IMigrateData, MigrateData
	{

		[MethodImpl(MethodImplOptions.InternalCall, MethodCodeType=MethodCodeType.Runtime)]
		public virtual extern void Migrate(IOleDbEncap _ode, int nDestVersion, bool _fStillValid);
	}
	#endregion

	public static class MigrateDataClass
	{

		delegate MigrateData MigrateDataClassDelegate();

		public static MigrateData Create()
		{
			if ((Application.OpenForms.Count > 0))
			{
				Form form = Application.OpenForms[0];
				if (form.InvokeRequired)
				{
					return (MigrateData)form.Invoke(new MigrateDataClassDelegate(Create));
				}
			}
			return new _MigrateDataClass();
		}
	}
	#endregion
}
