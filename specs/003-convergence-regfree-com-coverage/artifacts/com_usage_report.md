# COM Usage Audit Report

**Date:** November 19, 2025
**Generated by:** scripts/regfree/audit_com_usage.py

## Executive Summary

The COM usage audit scanned all known executables in the FieldWorks repository to identify which ones require Registration-Free COM manifests. The audit checked for:
- Direct P/Invoke to `ole32.dll`
- `[ComImport]` attributes
- References to `FwKernel` or `Views` namespaces
- Project references to `ViewsInterfaces`
- Package references to `SIL.LCModel`

**LexText.exe** (formerly Flex.exe) is confirmed removed from the repository and does not require a manifest.

## Findings

| Executable                  | Priority | Uses COM? | Key Indicators                           |
| :-------------------------- | :------- | :-------- | :--------------------------------------- |
| **FieldWorks.exe**          | P0       | **Yes**   | Heavy usage (Views: 236, FwKernel: 5)    |
| **LCMBrowser.exe**          | P1       | **Yes**   | Heavy usage (Views: 197, FwKernel: 5)    |
| **UnicodeCharEditor.exe**   | P1       | **Yes**   | Moderate usage (Views: 105, FwKernel: 5) |
| **MigrateSqlDbs.exe**       | P2       | **Yes**   | Moderate usage (Views: 73, FwKernel: 4)  |
| **FxtExe.exe**              | P2       | **Yes**   | Heavy usage (Views: 197, FwKernel: 5)    |
| **FixFwData.exe**           | P2       | No        | No indicators found                      |
| **ComManifestTestHost.exe** | Test     | No        | No indicators found                      |
| **ConverterConsole.exe**    | P3       | No        | No indicators found                      |
| **Converter.exe**           | P3       | No        | No indicators found                      |
| **ConvertSFM.exe**          | P3       | No        | No indicators found                      |
| **SfmStats.exe**            | P3       | No        | No indicators found                      |

## Recommendations

1.  **FieldWorks.exe**: Requires a comprehensive RegFree COM manifest. This is the main application entry point.
2.  **LCMBrowser.exe**: Requires a RegFree COM manifest.
3.  **UnicodeCharEditor.exe**: Requires a RegFree COM manifest.
4.  **MigrateSqlDbs.exe**: Requires a RegFree COM manifest.
5.  **FxtExe.exe**: Requires a RegFree COM manifest.

The other executables do not appear to require RegFree COM manifests at this time, based on static analysis.

## Next Steps

- Generate `FieldWorks.regfree.manifest` containing all required COM classes.
- Update the build system to embed or deploy this manifest for the identified executables.
- Verify runtime behavior in a clean environment (no registry keys).

## Excluded / Internal Tools

The following executables were identified in the repository but excluded from the primary audit as they are internal build/test tools:
- `Src/views/lib/VwGraphicsReplayer/VwGraphicsReplayer.csproj`
- `Src/InstallValidator/InstallValidator.csproj`
- `Src/GenerateHCConfig/GenerateHCConfig.csproj`
- `Build/Src/NUnitReport/NUnitReport.csproj`
